<script>
const API_URL = "https://script.google.com/macros/s/AKfycbz6KTD-wyy7o0JQKMxBctAHLjD_l8vdZNklQheZaLj8ZtJQqVM4jsUnkNBYF239BNcTOw/exec";

function initGallery(items){
  const wrap = document.getElementById('gallery');
  const status = document.getElementById('status');
  if (!Array.isArray(items) || items.length === 0){
    status.textContent = "No images found (or folder/files not shared).";
    return;
  }
  status.remove();

  items.forEach(p=>{
    const full  = `https://drive.google.com/uc?export=view&id=${p.id}`;
    const thumb = `https://drive.google.com/thumbnail?id=${p.id}&sz=w800`;
    const a = document.createElement('a');
    a.className='tile';
    a.href = full;
    a.setAttribute('data-lightbox','purple');
    a.setAttribute('data-title',(p.name||'').replace(/\.[^.]+$/,''));
    const img = document.createElement('img');
    img.src = thumb; img.alt = p.name||'Photo'; img.loading='lazy';
    a.appendChild(img); wrap.appendChild(a);
  });
}

fetch(API_URL)
  .then(r => {
    if (!r.ok) throw new Error('HTTP '+r.status);
    return r.json();
  })
  .then(initGallery)
  .catch(err => {
    const s = document.getElementById('status');
    s.className = 'error';
    s.textContent = 'Failed to load images: ' + err.message;
  });
</script>
